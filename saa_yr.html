diff --git a/saa_yr.html b/saa_yr.html
index f25240231697f01103989164536cb42ee12e5fd0..17662084356debe6956b77d6173b40537184b6e3 100644
--- a/saa_yr.html
+++ b/saa_yr.html
@@ -52,50 +52,75 @@
 
 <script>
 (function(){
   var out = document.getElementById('out');
   window.addEventListener('error', function(e){
     var msg = (e && e.message) ? e.message : String(e);
     var where = (e && e.filename) ? "\n@ "+e.filename+":"+(e.lineno||'')+":"+(e.colno||'') : '';
     out.innerHTML = '<div class="err">Virhe: '+msg+where+'</div>' + out.innerHTML;
   });
 
   var q = new URLSearchParams(location.search);
   var LAT_STR = q.get('lat'); var LON_STR = q.get('lon');
   var LAT = parseFloat(LAT_STR); var LON = parseFloat(LON_STR);
   var TZ  = 'Europe/Helsinki';
   var DBG = q.has('dbg');
   function tag(s){ return DBG ? ' <span class="soft" style="font-size:12px">'+s+'</span>' : ''; }
 
   var pageTitle = document.getElementById('pageTitle');
   if (LAT_STR === '60.3281' && LON_STR === '25.0551'){ pageTitle.textContent = 'Korso'; pageTitle.style.display='block'; }
   if (LAT_STR === '60.1562' && LON_STR === '24.7767'){ pageTitle.textContent = 'MERIKOTO'; pageTitle.style.display='block'; }
 
   function fmt(d, opts){ return d.toLocaleString('fi-FI', Object.assign({timeZone:TZ}, opts||{})); }
   function fmtH(d){ return fmt(d, {hour:'numeric'}); }
   function fmtHM(d){ return fmt(d, {hour:'numeric', minute:'2-digit'}); }
 
+  function toZonedDate(date, timeZone){
+    var parts = new Intl.DateTimeFormat('en-CA', {
+      timeZone: timeZone,
+      year: 'numeric',
+      month: 'numeric',
+      day: 'numeric',
+      hour: 'numeric',
+      minute: 'numeric',
+      second: 'numeric',
+      hour12: false
+    }).formatToParts(date);
+    var obj = {};
+    for (var i=0;i<parts.length;i++){
+      if (parts[i].type !== 'literal') obj[parts[i].type] = parts[i].value;
+    }
+    return new Date(
+      Number(obj.year || 0),
+      Number(obj.month || 1)-1,
+      Number(obj.day || 1),
+      Number(obj.hour || 0),
+      Number(obj.minute || 0),
+      Number(obj.second || 0)
+    );
+  }
+
   function baseSym(s){
     if (!s) return '';
     // MET symbolit voivat olla tyyppiä "partlycloudy_day"
     var i = s.indexOf('_'); return (i>0 ? s.slice(0,i) : s);
   }
   function isNcClear(s){
     var b = baseSym(s);
     return (b==='clearsky' || b==='fair' || b==='partlycloudy');
   }
   function ncSymbolText(sym){
     if (!sym) return null;
     var b = baseSym(sym);
     var MAP = {
       clearsky: "sinistä",
       fair: "sangen sinistä",
       partlycloudy: "siniharmaata",
       cloudy: "harmaata",
       lightrainshowers: "Jokunen kuuro.",
       heavyrainshowers: "Äänekästä kuuroa.",
       rainshowersandthunder: "Sepon välisuihkut.",
       thunderstorm: "Seppo riehuu.",
       heavyrain: "Saavista kaatuu.",
       lightrain: "Ripsii.",
       sleet: "Räntää.",
       lightsleetshowers_and_thunder: "Sepon tiskivuoro.",
diff --git a/saa_yr.html b/saa_yr.html
index f25240231697f01103989164536cb42ee12e5fd0..17662084356debe6956b77d6173b40537184b6e3 100644
--- a/saa_yr.html
+++ b/saa_yr.html
@@ -333,51 +358,51 @@
               };
             }
           }
           return null;
         }
         var nc0 = pickNc(keys[0]) || null;
         var nc1 = keys[1] ? (pickNc(keys[1]) || null) : null;
         var nc2 = keys[2] ? (pickNc(keys[2]) || null) : null;
 
         // päivän auringonajat cacheen
         var dayObjs = {};
         function dayObjFor(d){
           var y=d.getFullYear(), m=d.getMonth(), da=d.getDate();
           var key = y+'-'+m+'-'+da;
           if (dayObjs[key]) return Promise.resolve(dayObjs[key]);
           return fetchSunDay(new Date(y,m,da,12,0,0), LAT, LON).then(function(o){ dayObjs[key]=o; return o; });
         }
 
         var html = [];
         var prevDescRef = { val:null };
 
         function renderHour(idx){
           if (idx>=keys.length) return Promise.resolve();
           var key = keys[idx];
           var dUtc = new Date(key);
-          var dLoc = new Date(dUtc.toLocaleString('en-CA',{timeZone:TZ}));
+          var dLoc = toZonedDate(dUtc, TZ);
 
           var T = forecast.air_temperature.get(key);
           var W = forecast.wind_speed.get(key);
           var WD = forecast.wind_from_direction.get(key);
           var R = forecast.precipitation_amount.get(key);
           var SYM = forecast.SmartSymbol.get(key);
 
           var isNow = (idx===0);
           var isFutureNc = (idx===1 || idx===2);
 
           // sade
           var rObj, rTag, usedRain=null;
           if (isNow || isFutureNc){
             var pack = idx===0?nc0:(idx===1?nc1:nc2);
             var val = (pack && typeof pack.val==='number') ? pack.val : null;
             if (val!=null && val<0.1) rObj = {text:'—', cls:'soft dash', num:0};
             else rObj = rainCell(val, false);
             rTag='NC'; usedRain = (typeof val==='number'?val:null);
           } else {
             rObj = rainCell(R, false);
             usedRain = (typeof R==='number'?R:null);
             rTag='HRM';
             if (usedRain>0 && usedRain<0.3){
               var b = baseSym(SYM||'');
               var except = { thunderstorm:1, rainshowers:1, sleetshowers:1, snowshowers:1, heavyrainshowers:1 };
